## Linux 檔案目錄結構
### `/etc` 是什麼的縮寫？這裡通常都放哪些檔案？

- **`/etc`** 是 "Editable Text Configuration" 的縮寫，這是 Linux 和 Unix 系統中的一個目錄，通常存放系統的配置文件。
- **用途**：
  - 包含系統管理和配置的靜態文件。
  - 包含許多重要的系統配置文件，如網絡配置、用戶賬戶信息、服務啟動腳本等。

- **常見的文件和目錄**：
  - `/etc/passwd`：用戶賬戶信息文件。
  - `/etc/nginx/`：Nginx 的配置目錄。
  - `/etc/ssh/`：SSH 服務配置文件。

### `/var` 這裡通常都放哪些檔案？

- **`/var`** 是 "Variable" 的縮寫，存放會經常變動的數據，如日誌文件、緩存文件和臨時數據等。
- **用途**：
  - 包含動態數據，比如系統運行過程中的日誌、郵件、緩存、暫存文件等。

- **常見的文件和目錄**：
  - `/var/log/`：系統和應用程序的日誌文件。
  - `/var/tmp/`：系統的臨時文件。
  - `/var/spool/`：郵件、打印機等排隊等待處理的數據。


### `/boot` 這裡通常都放哪些檔案？

- **`/boot`** 目錄中存放的是系統啟動時所需要的文件。
- **用途**：
  - 包含 Linux 核心和啟動加載器所需的文件，比如 **GRUB** 配置文件、內核映像文件、啟動時用到的初始化文件等。

- **常見的文件**：
  - `/boot/vmlinuz`：壓縮的 Linux 內核。
  - `/boot/initrd.img`：初始化內存映像。
  - `/boot/grub/`：GRUB 啟動加載器的配置文件。


### `$PATH` 環境變數的作用是什麼？

- **`$PATH`** 是一個環境變數，定義了系統在執行命令時，將在哪些目錄中搜索可執行文件。
- **用途**：
  - 當你在命令行中輸入一個命令（如 `ls` 或 `cd`）時，系統會按照 `$PATH` 中定義的目錄順序來查找該命令的可執行文件，並執行它。
  
- **範例**：
  - 當你輸入 `ls` 時，系統會查看 `$PATH` 中定義的所有目錄，尋找該命令的可執行文件。

### `which` 指令的作用

- **`which`** 指令的作用是顯示給定命令的完整路徑。
- **用途**：
  - 幫助你確定某個命令對應的可執行文件位於系統的哪個目錄中。
  
- **範例**：
  - 當你輸入 `which ls`，系統會返回 `ls` 命令的所在位置，例如 `/usr/bin/ls`。

---

## 1.
**PublicIP**: `35.77.225.119`

---

## 2.
**Instance Type** 是指特定配置的虛擬機（EC2 執行個體）的硬體規格。每種 **Instance Type** 定義了 **CPU**（處理器核心）、**內存**（RAM）、**儲存類型**及其大小，以及**網絡性能**等資源的組合，適合不同類型的工作負載。

常見的 **EC2 Instance Type** 分為幾大類，根據工作負載需求的不同進行分類：

- **通用型 (General Purpose)**：
  - 適合多種工作負載，提供平衡的計算、內存和網絡資源。
  - 例如：`t3`、`t2`、`m5`、`m6g`

- **計算優化型 (Compute Optimized)**：
  - 提供高性能 CPU，適合計算密集型應用，如高性能計算和批量處理。
  - 例如：`c5`、`c6g`

- **內存優化型 (Memory Optimized)**：
  - 提供較大的內存資源，適合內存密集型應用，如大數據處理和內存內分析。
  - 例如：`r5`、`x1e`

- **加速計算型 (Accelerated Computing)**：
  - 配有 GPU 或 FPGA，適合機器學習、視覺渲染等需要硬體加速的工作負載。
  - 例如：`p3`、`g4dn`

- **儲存優化型 (Storage Optimized)**：
  - 提供高吞吐量的本地存儲，適合大數據工作負載和低延遲數據庫應用。
  - 例如：`i3`、`d2`

---

## 3.
**Nginx** 是一個高性能的開源網絡伺服器和反向代理伺服器，最初是為了處理高負載的 **HTTP 流量**而開發的。它還可以用作電子郵件代理伺服器（**IMAP**、**POP3**、**SMTP**）和負載均衡器。

### **Nginx 的用途**

1. **靜態內容服務 (Static Content Serving)**：
   - Nginx 擅長處理靜態資源（如 HTML、CSS、JavaScript、圖像等）。
  
2. **反向代理 (Reverse Proxy)**：
   - Nginx 可作為反向代理，將請求轉發到後端伺服器（如 Node.js、Django、Flask），提升安全性與負載分配。
  
3. **負載均衡 (Load Balancing)**：
   - Nginx 支持多種負載均衡算法，可在多台後端伺服器之間分配請求，實現高可用性與故障轉移。
  
4. **SSL/TLS 終止 (SSL/TLS Termination)**：
   - Nginx 負責加密與解密，減少後端伺服器的負擔。
  
5. **動態內容處理 (Dynamic Content Handling)**：
   - 可與 FastCGI 或其他應用伺服器集成來處理動態內容。

---

## 4.
**PM2** 是一個用於 **Node.js 應用** 的進程管理器，適合在生產環境中運行持久性應用。它支持進程守護、錯誤重啟、負載均衡等功能。

### **PM2 的主要用途**

1. **進程管理**：
   - PM2 可以管理和監控多個 Node.js 應用進程，並確保應用在崩潰後自動重啟。

2. **守護進程模式 (Daemon Mode)**：
   - 使應用在後台自動持續運行，無需手動干預。

3. **負載均衡 (Cluster Mode)**：
   - 支持多個進程運行同一個應用，實現多核 CPU 的充分利用。

4. **日誌管理**：
   - 提供日誌查看和管理功能，幫助開發者排查問題。

### **PM2 的常用命令**
- 啟動應用：`pm2 start app.js`
- 停止應用：`pm2 stop <app_name>`
- 重啟應用：`pm2 restart <app_name>`
- 查看日誌：`pm2 logs`
- 查看運行中的應用：`pm2 list`

---

## 5.
**Proxy** 是一種中間伺服器，用於轉發客戶端請求到目標伺服器，並返回伺服器的響應。根據代理的方向和功能，代理伺服器分為：

1. **Forward Proxy（正向代理）**：
   - 位於客戶端與外部伺服器之間，代表客戶端與外部伺服器通信。
   
2. **Reverse Proxy（反向代理）**：
   - 位於客戶端與伺服器之間，代表伺服器接收來自客戶端的請求並將其轉發至後端伺服器。

### **為什麼要透過 Nginx 來 proxy 到 Express Web Server？**
- **負載均衡**：Nginx 能將請求分配到多個 Express 實例，提升應用擴展性。
- **性能提升**：靜態資源由 Nginx 處理，動態內容由 Express 處理，分離靜態和動態資源處理提高性能。
- **安全性**：Nginx 作為中介，隱藏後端 Express 伺服器，增強安全性。
- **SSL 加密處理**：Nginx 管理 SSL/TLS，減少 Express 的負擔。

---

## 6.
在nginx.conf中的http區塊中加上
```nginx
server {
  listen 80;
  server_name 35.77.225.119;

  location / {
   proxy_pass http://localhost:3000;
   proxy_http_version 1.1;
   proxy_set_header Upgrade $http_upgrade;
   proxy_set_header Connection 'upgrade';
   proxy_set_header Host $host;
   proxy_cache_bypass $http_upgrade;
  }
}
```

## 7.
**Security Group** 是 AWS 中的一種虛擬防火牆，專門用於控制 EC2 執行個體的網絡流量。它通過定義一組允許或拒絕的規則來控制哪些流量可以進入（入站）或離開（出站）與其關聯的 EC2 執行個體。

### **Security Group 的用途**

1. **控制入站流量**：
   - **Security Group** 可以定義哪些 **IP 地址** 或範圍的 IP 地址可以連接到 **EC2** 執行個體的特定端口。
   - 例如，開放 **SSH** 連接（端口 `22`）或 **HTTP** 請求（端口 `80`）。

2. **控制出站流量**：
   - **Security Group** 同樣可以定義 **EC2** 執行個體可以連接到哪些外部系統或網絡，這在需要限制執行個體對外部訪問時非常有用。

3. **強化應用安全**：
   - 通過使用 **Security Group**，可以限制流量的來源或目的，減少不必要的暴露，降低潛在的安全風險。

4. **自動拒絕未允許的流量**：
   - **Security Group** 是基於 "允許" 規則運作的，這意味著任何未明確允許的流量都會被自動拒絕。

### **Security Group 的特性**

1. **狀態化**：
   - **Security Group** 是狀態化的防火牆，如果允許某個連接進入 EC2，那麼對應的出站流量也自動允許，反之亦然。

2. **只能有允許規則**：
   - **Security Group** 只能定義允許規則（`Allow Rules`），不能定義拒絕規則。所有不在規則範圍內的流量都會被自動拒絕。

3. **多個 Security Group**：
   - 可以將多個 **Security Group** 關聯到同一個 EC2 執行個體。所有關聯的 **Security Group** 的規則會合併執行。

4. **無法追溯修改**：
   - 一旦對 **Security Group** 規則進行修改，這些更改會立即生效，並影響所有關聯的 EC2 執行個體。

### **Security Group 的設定原則**

1. **最小權限原則**：
   - 僅開放必要的端口和 **IP 地址**，限制不必要的流量。
   - 例如，只允許來自特定 IP 地址的 **SSH** 連接，或者只允許來自指定負載均衡器的流量進入 Web 應用。

2. **精確範圍**：
   - 使用最小範圍的 **IP 地址**或網段。避免使用過於寬泛的範圍，如 `0.0.0.0/0`，這表示允許所有 **IP 地址** 連接。

3. **隔離環境**：
   - 為不同的應用環境（如開發、測試和生產環境）設置不同的 **Security Group**，以確保不同環境之間的網絡隔離，防止開發中的問題影響生產系統。

4. **特定端口開放**：
   - 僅開放需要的端口。例如，對 **Web 伺服器** 可能只需要開放 **HTTP** 端口（`80`）和 **HTTPS** 端口（`443`），而對於 **數據庫伺服器**，只允許內部網絡的流量來訪問其服務端口（如 **MySQL** 的 `3306` 端口）。

5. **監控和審計**：
   - 定期審查和更新 **Security Group** 規則，確保其符合最新的安全需求。刪除不必要的允許規則，避免潛在的安全風險。

6. **分層和細化**：
   - 為不同功能的伺服器創建不同的 **Security Group**。例如，**Web 伺服器** 的 **Security Group** 只允許 **HTTP/HTTPS** 流量，而 **應用伺服器** 的 **Security Group** 則允許來自 **Web 伺服器** 的請求，**數據庫伺服器** 只允許內部網絡訪問。

### **設定 Security Group 的示例**

1. **Web 伺服器**：
   - **入站規則**：
     - 允許 **HTTP**（端口 `80`）來自所有 **IP 地址** (`0.0.0.0/0`)。
     - 允許 **HTTPS**（端口 `443`）來自所有 **IP 地址** (`0.0.0.0/0`)。
   - **出站規則**：
     - 允許所有出站流量（預設）。

2. **SSH 管理（限特定 IP）**：
   - **入站規則**：
     - 允許 **SSH**（端口 `22`）來自指定管理員 **IP 地址** (`123.123.123.123/32`)。
   - **出站規則**：
     - 允許所有出站流量（預設）。

3. **數據庫伺服器**：
   - **入站規則**：
     - 允許 **MySQL**（端口 `3306`）來自應用伺服器的內部 **IP 地址** 範圍（例如 `10.0.1.0/24`）。
   - **出站規則**：
     - 允許所有出站流量（預設）。

---

## 8.
**`sudo`** 是 Unix 和 Linux 系統中的一個命令，代表 **Superuser Do**，其作用是以超級用戶（**root** 用戶）的權限來執行特定的命令。

### **為什麼需要使用 `sudo`？**

在 Linux 系統中，系統設置分為兩個層級：

1. **普通用戶層級**：
   - 普通用戶只能修改和操作自己擁有的文件和進程，不能更改系統層級的設置或文件。

2. **系統層級**：
   - 包括系統設置、軟件安裝、全局配置文件的修改等，這些操作需要 **root**（超級用戶）或具有類似權限的用戶。

使用 **`sudo`** 可以：
1. 執行需要系統層級權限的命令，例如安裝軟件、修改系統設置、操作全局配置文件等。
2. 保持系統安全，僅在特定命令下進行提權操作，避免以 **root** 身份長期登錄導致潛在的安全風險。

---

## 9.
**Nginx 日誌文件** 通常存儲在以下預設路徑中：

- **訪問日誌**：`/var/log/nginx/access.log`
- **錯誤日誌**：`/var/log/nginx/error.log`

這些檔案記錄了 Nginx 伺服器處理的每個請求（訪問日誌）以及伺服器運行中發生的錯誤（錯誤日誌）。

### **如何找到 Nginx 的 Log 文件**

1. **查看 Nginx 配置文件**：
   - Nginx 日誌文件的路徑可以在配置文件中自定義。配置文件通常位於 `/etc/nginx/nginx.conf` 或 `/etc/nginx/conf.d/` 目錄中。
   - 可以使用以下命令檢查日誌文件的具體路徑：
     ```bash
     cat /etc/nginx/nginx.conf | grep log
     ```

   - 例如，在配置文件中應該能看到如下設置：
     ```nginx
     access_log /var/log/nginx/access.log;
     error_log /var/log/nginx/error.log;
     ```

2. **檢查日誌目錄**：
   - Nginx 的日誌文件通常存儲在 `/var/log/nginx/` 目錄下，可以使用以下命令來查看該目錄：
     ```bash
     ls /var/log/nginx/
     ```

### **如何查看 Nginx 的 Log**

1. **使用 `cat` 命令查看整個日誌文件**：
   - 如果想查看整個日誌文件，可以使用以下命令：
     ```bash
     cat /var/log/nginx/access.log
     cat /var/log/nginx/error.log
     ```

2. **使用 `tail` 命令查看最新的日誌條目**：
   - 如果只想查看日誌的最新條目，可以使用 `tail` 命令：
     ```bash
     tail /var/log/nginx/access.log
     tail /var/log/nginx/error.log
     ```

   - 若想動態查看日誌文件的更新，可以使用 `-f` 參數：
     ```bash
     tail -f /var/log/nginx/access.log
     tail -f /var/log/nginx/error.log
     ```

3. **使用 `grep` 命令篩選特定條目**：
   - 如果你想篩選出某些特定的請求或錯誤，可以使用 `grep` 命令。例如，查看所有 **404** 錯誤：
     ```bash
     grep "404" /var/log/nginx/access.log
     ```

4. **使用 `less` 命令翻頁瀏覽**：
   - 如果日誌文件非常大，可以使用 `less` 命令來逐頁瀏覽和搜索日誌：
     ```bash
     less /var/log/nginx/access.log
     ```

## 10.
一開始沒有設定好`security group`，以為是`nginx`沒設定好，
於是在本機上用curl `http://localhost:80`測試，是可以成功的，推測高機率是防火牆的問題，找到security group的設定，把80port打開，便可以在internet上成功連接了。

## 11.
所有資料來自`chatgpt`並實際動手驗證過。